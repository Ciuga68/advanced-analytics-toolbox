"use strict";define(["../chart/bubble_chart","../util/utils","ng!$q"],function(e,a,r){return{createCube:function(e,r){var t=r.layout,s=a.validateDimension(t.props.dimensions[0]),l=[{qDef:{qFieldDefs:[s]}}],i=a.validateMeasure(t.props.measures[0]),o=a.validateMeasure(t.props.measures[1]),n=[{qDef:{qDef:i}},{qDef:{qDef:o}},{qDef:{qLabel:"Fit",qDef:"R.ScriptEval('lm_result <- lm(q$Measure2~q$Measure1);predict(lm_result, interval=\""+t.props.interval+'", level='+t.props.confidenceLevel+")[,1]',"+i+" as Measure1, "+o+" as Measure2)"}},{qDef:{qLabel:"Lower",qDef:"R.ScriptEval('lm_result <- lm(q$Measure2~q$Measure1);predict(lm_result, interval=\""+t.props.interval+'", level='+t.props.confidenceLevel+")[,2]',"+i+" as Measure1, "+o+" as Measure2)"}},{qDef:{qLabel:"Upper",qDef:"R.ScriptEval('lm_result <- lm(q$Measure2~q$Measure1);predict(lm_result, interval=\""+t.props.interval+'", level='+t.props.confidenceLevel+")[,3]',"+i+" as Measure1, "+o+" as Measure2)"}}];return r.backendApi.applyPatches([{qPath:"/qHyperCubeDef/qDimensions",qOp:"replace",qValue:JSON.stringify(l)},{qPath:"/qHyperCubeDef/qMeasures",qOp:"replace",qValue:JSON.stringify(n)}],!1),r.patchApplied=!0,null},drawChart:function(t,s){var l=r.defer(),i=t.layout,o=a.validateDimension(i.props.dimensions[0]),n=[{qTop:0,qLeft:0,qWidth:6,qHeight:1500}];return t.backendApi.getData(n).then(function(r){var n=t.layout.qHyperCube.qMeasureInfo;if(isNaN(n[2].qMin)&&isNaN(n[2].qMax)&&isNaN(n[3].qMin)&&isNaN(n[3].qMax)&&isNaN(n[4].qMin)&&isNaN(n[4].qMax))a.displayConnectionError(t.extId);else{var u=a.getDefaultPaletteColor(),p=[],m=[],q=[],c=[],d=[],f=[],v=[],b=r[0].qMatrix.map(function(e){return{elemNum:e[0].qElemNumber,dim1:e[0].qText,mea1:e[1].qNum,mea2:e[2].qNum,mea3:e[3].qNum,mea4:e[4].qNum,mea5:e[5].qNum}});b.sort(function(e,a){return parseFloat(e.mea1)-parseFloat(a.mea1)}),$.each(b,function(e,a){p.push(a.elemNum),m.push(a.dim1),q.push(a.mea1),c.push(a.mea2),d.push(a.mea3),f.push(a.mea4),v.push(a.mea5)});var h=[{x:q,y:c,elemNum:p,text:m,name:o,mode:"markers",type:"scatter",marker:{color:i.props.colors?"rgba("+u[3]+",0.8)":"rgba("+u[i.props.colorForMain]+",0.8)",size:i.props.bubbleSize}},{x:q,y:d,name:"Fit",line:{color:"rgba("+u[i.props.colorForSub]+",1)"}},{x:q,y:f,name:"Lower",fill:"tonexty",fillcolor:"rgba("+u[i.props.colorForSub]+",0.3)",type:"scatter",mode:"none"},{x:q,y:v,name:"Upper",fill:"tonexty",fillcolor:"rgba("+u[i.props.colorForSub]+",0.3)",type:"scatter",mode:"none"}];$(".advanced-analytics-toolsets-"+t.extId).html('<div id="aat-chart-'+t.extId+'" style="width:100%;height:100%;"></div>');var M=e.draw(t,s,h,"aat-chart-"+t.extId,null);e.setEvents(M,t,s)}return l.resolve()}),l.promise}}});
//# sourceMappingURL=../../maps/analysis/simple_linear_bubble.js.map
