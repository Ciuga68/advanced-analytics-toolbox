"use strict";define(["../chart/line_chart","../util/utils","ng!$q"],function(e,a,r){return{createCube:function(e,r){var s=r.layout,t=a.validateDimension(s.props.dimensions[0]),o=[{qDef:{qFieldDefs:[t]}}],i=s.props.measures.length;r.rowsLabel=["(Intercept)",a.validateMeasure(s.props.measures[1])];for(var p=a.validateMeasure(s.props.measures[0])+" as mea0, "+a.validateMeasure(s.props.measures[1])+" as mea1",l="q$mea0 ~ q$mea1",n="NN",u=2;u<i;u++){var d=a.validateMeasure(s.props.measures[u]);if(d.length>0){var q=","+d+" as mea"+u;p+=q,l+=" + q$mea"+u,n+="N",r.rowsLabel.push(a.validateMeasure(s.props.measures[u]))}}var c=[{qDef:{qDef:"R.ScriptEvalExStr('"+n+"','library(jsonlite);lm_result <- lm("+l+");res<-toJSON(coef(summary(lm_result)));res;',"+p+")"}},{qDef:{qLabel:"-",qDef:""}},{qDef:{qLabel:"-",qDef:""}},{qDef:{qLabel:"-",qDef:""}},{qDef:{qLabel:"-",qDef:""}}];return r.backendApi.applyPatches([{qPath:"/qHyperCubeDef/qDimensions",qOp:"replace",qValue:JSON.stringify(o)},{qPath:"/qHyperCubeDef/qMeasures",qOp:"replace",qValue:JSON.stringify(c)}],!1),r.patchApplied=!0,null},drawChart:function(s){var t=r.defer(),o=s.layout,i=(a.validateDimension(o.props.dimensions[0]),[{qTop:0,qLeft:0,qWidth:6,qHeight:1}]);return s.backendApi.getData(i).then(function(r){s.layout.qHyperCube.qMeasureInfo;if(0===r[0].qMatrix[0][1].qText.length||"-"==r[0].qMatrix[0][1].qText)a.displayConnectionError(s.extId);else{var i=a.getDefaultPaletteColor(),p=JSON.parse(r[0].qMatrix[0][1].qText),l=[],n=[],u=[];$.each(p,function(e,a){l.push(a[0]),n.push(a[1]),u.push(Math.abs(a[0]+a[1])),u.push(Math.abs(a[0]-a[1]))});var d=Math.max.apply(null,u),q=[{x:l,y:s.rowsLabel,name:"Coefficients plot",error_x:{type:"data",symmetric:!1,array:n,arrayminus:n,thickness:o.props.borderWidth,color:o.props.colors?"rgba("+i[3]+",1)":"rgba("+i[o.props.colorForMain]+",1)"},type:"scatter",mode:"markers",marker:{color:o.props.colors?"rgba("+i[3]+",1)":"rgba("+i[o.props.colorForMain]+",1)",size:o.props.pointRadius}}],c={showlegend:s.layout.props.showLegend,xaxis:{showgrid:s.layout.props.xScale,side:s.layout.props.xAxisPosition,range:[1.1*d*-1,1.1*d]},yaxis:{showgrid:s.layout.props.yScale,side:s.layout.props.yAxisPosition,autorange:"reversed",range:[-1,s.rowsLabel.length]},separators:a.getSeparators(s,0),dragmode:"select",margin:{r:"right"==s.layout.props.yAxisPosition?80:10,l:"left"==s.layout.props.yAxisPosition?80:10,t:"top"==s.layout.props.xAxisPosition?80:10,b:"bottom"==s.layout.props.xAxisPosition?80:10}};$(".advanced-analytics-toolsets-"+s.extId).html('<div id="aat-chart-'+s.extId+'" style="width:100%;height:100%;"></div>'),e.draw(s,q,"aat-chart-"+s.extId,c)}return t.resolve()}),t.promise}}});
//# sourceMappingURL=../../maps/analysis/coefplot.js.map
